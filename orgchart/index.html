<html>
  <head>
    <title>Org chart fed from google sheet</title>

    <script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js'></script>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css">

  <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="orgchartfromsheet.js" type="text/javascript"></script>
    <script src="https://apis.google.com/js/auth.js?onload=init"></script>

    <style>
      body {font-family:Arial;}
      header {background-color:#ddd;}
      #sidebar{background-color:#fafafa;border:1px solid #aaa;border-radius:5px;cursor:default !important;}

      /* org chart */
      .node-header {background-color:rgba(255, 255, 255, 0.5);text-align:left;}
      .node-avatar {height:35px;float:left;}
      .node-name {font-weight:bold;}
      .node-info {color:#555;}
      .node-team {color:red;}
      
      </style>
  </head>

  <body>

      <header>
          <div class="container"><h1>Org Chart from Google Sheet</h1></div>
        </header>

          <div class="container">
        <div class="col-md-9">
           
    <br />
    <div class="panel panel-success">
        <div class="panel-heading">Config auth & data source</div>
        <div class="panel-content" style="padding:10px;">
          <strong>Welcome!</strong> This page shows an org chart driven by a google sheet. <br />
          <a href="https://docs.google.com/spreadsheets/d/12akgYh-crO4jv7lrsJ5dVrtrXdsxORfLkWdVKNqme_M/" target="_blank">Public Example sheet</a> | 
          <a href="https://docs.google.com/spreadsheets/d/12akgYh-crO4jv7lrsJ5dVrtrXdsxORfLkWdVKNqme_M/gviz/tq?sheet=orgdata&range=A1:B5" target="_blank">(as JSON)</a> |
          <a href="https://google-developers.appspot.com/chart/interactive/docs/spreadsheets#sheet-name" target="_blank">Google documentation</a> |
        <a href="https://jsfiddle.net/gvaz4qb0/" target="_blank">jsfiddle inspiration</a>
          
          <div id="auth-todo">
            Authorize app with google sheets: <button class="btn btn-primary" onClick="handleAuthClick();">Authorize</button>
          </div>

          <div id="auth-done" style="display:none;">
              Authorized! <a href="#" onClick="handleAuthClick();">Re-authorize</a>
            </div>
    <br />Source sheet URL:
    <input type="text" id="sheeturl" class="form-control" style="display:inline;width:auto;" />
    <button class="btn btn-default" onClick="loadChart();">Load chart</button><br />
  </div></div>

    <!--Div that will hold the chart-->
    <div id="chart_div"></div>

    </div>

    

  </div>
  </body>
</html>
